zerops:
  - setup: bun0
    # ==== how to build your application ====
    build:
      # what technologies should the build
      # container be based on (can be an array)
      base:
        - bun@1.1
        - nodejs@latest

      os: ubuntu

      # what commands to use to build your app
      prepareCommands:
        - echo "Upgrading bun to 1.1.32"
        - bun upgrade
      buildCommands:
        - bun install
        - bun run postinstall
        - bun run build

      # select which files / folders to deploy
      # after the build succesfully finished
      deployFiles:
        - dist
        - package.json
        - node_modules

      # *optional*: which files / folders
      # to cache for the next build run
      cache:
        - node_modules
        - bun.lockb

    # ==== how to run your application ====
    run:
      # what technology should the runtime
      # container be based on, can be extended
      # in `run.prepareCommands` using
      # `zsc install nodejs@20`
      base: bun@1.1
      os: ubuntu
      ports:
        - port: 3000
          httpSupport: true
      prepareCommands:
        - echo "Upgrading bun to 1.1.32"
        - bun upgrade
      start: bun run dev

    deploy:
      readinessCheck:
        httpget:
          path: /docs
          port: 3000
